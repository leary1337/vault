---
создал заметку: 2024-07-24
tags:
  - golang
---
### Описание
Модель памяти и сборщик мусора (GC) в Go играют ключевую роль в управлении памятью и производительностью приложений. Go предоставляет автоматическое управление памятью, освобождая разработчиков от необходимости вручную освобождать память, что снижает вероятность ошибок и утечек памяти.

### Модель памяти в Go

Go использует модель памяти с автоматическим управлением, что означает, что память для объектов выделяется и освобождается автоматически. Это достигается с помощью сборщика мусора, который периодически освобождает память, занятую неиспользуемыми объектами.

#### Структура модели памяти

Модель памяти Go включает следующие основные компоненты:
- **Куча**: область памяти, из которой выделяются объекты динамически. Сюда помещаются объекты с длительным временем жизни, такие как глобальные переменные и объекты, передаваемые между горутинами.
- **Стек**: область памяти для локальных переменных функции. Стек используется для хранения данных, связанных с вызовами функций, и очищается по завершении функции.
- **Блоки памяти (arena)**: управляемые области памяти, используемые для выделения объектов различного размера.

### Сборщик мусора (GC)

Сборщик мусора (Garbage Collector) в Go отвечает за автоматическое освобождение неиспользуемой памяти. Go использует тригенерационный маркирующий сборщик мусора с параллельной остановкой мира (stop-the-world). Это означает, что сборщик работает в три этапа и временно приостанавливает выполнение всех горутин для обновления состояния памяти.

#### Этапы работы GC

1. **Маркировка**: сборщик мусора маркирует все активные объекты, начиная с корневых объектов (например, глобальные переменные и объекты в стеке).
2. **Сбор**: освобождение памяти для объектов, которые не были помечены как активные.
3. **Очистка**: пересборка свободной памяти и подготовка её к новому выделению.

### Настройка GC

Go позволяет настраивать поведение сборщика мусора с помощью переменной окружения `GOGC`, которая определяет процент прироста памяти между запусками сборщика. Например, `GOGC=100` означает, что сборщик мусора будет запускаться, когда использование памяти удвоится.

### Краткое содержание

Модель памяти и сборщик мусора в Go обеспечивают автоматическое управление памятью, что упрощает разработку и снижает вероятность ошибок. Сборщик мусора освобождает неиспользуемую память, улучшая производительность и предотвращая утечки памяти. Настройка GC позволяет адаптировать его поведение под потребности конкретного приложения, обеспечивая баланс между производительностью и использованием памяти.
