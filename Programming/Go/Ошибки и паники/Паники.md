---
создал заметку: 2024-07-24
tags:
  - golang
  - errors
---
### Описание

**Паники в Go** — это механизм обработки критических ошибок, который позволяет прервать выполнение программы в случае возникновения ситуации, из которой невозможно восстановиться. Паника обычно используется, когда программа находится в некорректном состоянии и продолжение её выполнения может привести к ещё большим проблемам.
#### Что такое паника?

Паника (*panic*) в Go — это встроенный механизм, который приводит к немедленному завершению программы, если возникает критическая ошибка. Она запускается вызовом встроенной функции `panic()`, которая принимает один аргумент — описание ошибки или проблему, из-за которой возникла паника. После вызова `panic()`, программа начинает “развертывать” стеки вызовов (unwind the stack), что позволяет завершить выполнение всех функций, и затем программа завершает работу.

Пример вызова паники:
```go
func divide(a, b int) int {
    if b == 0 {
        panic("division by zero")
    }
    return a / b
}
```
#### Обработка паник через defer

Go предоставляет механизм `defer` для отложенного выполнения функций, который можно использовать для обработки паник. В сочетании с функцией `recover()` можно “перехватить” панику и попытаться восстановить выполнение программы или корректно завершить её.

Пример использования `defer` и `recover` для обработки паник:
```go
func safeDivide(a, b int) (result int, err error) {
    defer func() {
        if r := recover(); r != nil {
            err = fmt.Errorf("panic occurred: %v", r)
        }
    }()
    result = a / b
    return result, nil
}
```
В этом примере, если возникнет паника (например, при делении на ноль), функция `recover()` вернёт значение, переданное в `panic()`, и программа не завершится немедленно, а вернёт ошибку.

#### Best Practices

1. **Использование паники только для критических ошибок**:
	Паника должна использоваться только в случаях, когда продолжение выполнения программы невозможно или небезопасно. Например, при обнаружении серьёзных программных ошибок или неразрешимых состояний

2. **Понимание последствий**:
	Паника приводит к завершению программы, поэтому важно понимать последствия её вызова. Если можно восстановиться после ошибки, лучше использовать механизм обработки ошибок через интерфейс [error](Обработка%20ошибок.md#Использование%20интерфейса%20error)

3. **Документация и логирование**:
	В случае паники важно задокументировать, почему и когда она возникает, а также записывать соответствующую информацию в логи. Это облегчит отладку и поддержку программы
### Краткое содержание

**Паники в Go** — это механизм для обработки критических ошибок, которые невозможно или небезопасно игнорировать. Они используются для немедленного завершения программы, но могут быть обработаны через `defer` и `recover()`. Паника должна применяться только в исключительных случаях, когда восстановление невозможно, а ошибки лучше обрабатывать через интерфейс error. ^88edb9

