---
создал заметку: 2024-07-24
tags:
  - golang
---
### Описание
Синхронизация данных в Go является ключевым аспектом при работе с горутинами. Она необходима для предотвращения гонок данных и обеспечения корректного доступа к общим ресурсам. Go предоставляет несколько примитивов для синхронизации, включая `Mutex`, `WaitGroup` и `Once`.

### Mutex

`Mutex` (mutual exclusion) используется для защиты критических секций кода, которые не должны выполняться одновременно несколькими горутинами. Это помогает избежать гонок данных.

Пример использования `Mutex`:
```go
var mu sync.Mutex
var balance int

func Deposit(amount int) {
    mu.Lock()
    balance += amount
    mu.Unlock()
}

func Balance() int {
    mu.Lock()
    defer mu.Unlock()
    return balance
}
```

### WaitGroup

`WaitGroup` используется для ожидания завершения группы горутин. Это удобно, когда нужно дождаться выполнения нескольких параллельных задач перед продолжением основной программы.

Пример использования `WaitGroup`:
```go
var wg sync.WaitGroup

wg.Add(1)
go func() {
    defer wg.Done()
    // Выполнение задачи
}()

wg.Wait() // Ожидание завершения всех задач
```

### Once

`Once` позволяет гарантировать, что инициализация или выполнение определенного действия произойдет только один раз, даже если это действие вызывается из нескольких горутин.

Пример использования `Once`:
```go
var once sync.Once

func setup() {
    fmt.Println("Setting up")
}

func main() {
    once.Do(setup)
    // Другие операции
}
```

### Краткое содержание

Синхронизация данных в Go обеспечивается с помощью таких примитивов, как `Mutex`, `WaitGroup` и `Once`. Эти инструменты помогают защитить критические секции, управлять выполнением параллельных задач и гарантировать единократное выполнение операций, что особенно важно при работе с общими ресурсами и многопоточными приложениями.
